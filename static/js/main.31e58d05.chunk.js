(this.webpackJsonpspwb=this.webpackJsonpspwb||[]).push([[0],{210:function(e,t,n){e.exports=n(265)},212:function(e,t,n){},235:function(e,t){},236:function(e,t){},244:function(e,t){},248:function(e,t){},249:function(e,t){},265:function(e,t,n){"use strict";n.r(t);n(211),n(212);var a=n(21),r=n.n(a),c=n(118),o=n(16),s=n(8),i=n(15),u=n(5),l=n.n(u),m=n(12),f=n(119),d=n.n(f),p=n(140),h=n(138),v=n.n(h),b=n(139),E=n.n(b),x=n(36),w=p.a("word2vec/model.json"),y=fetch("vocabulary.json").then((function(e){return e.json()})),g=new Promise((function(e){d.a.builder({dicPath:"dict"}).build((function(t,n){e(n)}))})),N=function(){var e=Object(m.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w;case 2:return n=e.sent,e.next=5,y;case 5:return a=e.sent,e.next=8,n.layers[3].getWeights()[0].transpose().array();case 8:return r=e.sent,e.abrupt("return",t.map((function(e){var t=e.word;return r[a[t]]})));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(m.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g;case 2:return n=e.sent,e.next=5,y;case 5:return a=e.sent,e.abrupt("return",n.tokenize(t).map((function(e){return e.basic_form})).filter((function(e){return e in a})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(e){var t,n={},a=Object(i.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;r in n||(n[r]=0),n[r]+=1}}catch(c){a.e(c)}finally{a.f()}return Object.entries(n).map((function(e){var t=Object(s.a)(e,2);return{word:t[0],count:t[1]}}))},O=function(e){var t=new v.a({dim:2,perplexity:30,earlyExaggeration:4,learningRate:100,nIter:200,metric:"euclidean"});return t.init({data:e,type:"dense"}),t.run(),t.getOutputScaled()},k=function(e,t){return E()(e,t).idxs},S=function(e){x.d(e).force("charge",x.c().strength(10)).force("collide",x.b().radius((function(e){return e.r+1})).iterations(30)).force("x",x.e(0)).force("y",x.f(0)).tick(100).stop()},C=function(){var e=Object(m.a)(l.a.mark((function e(t,n){var a,r,c,o,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.time("preprocess"),e.t0=M,e.next=4,j(t);case 4:return e.t1=e.sent,a=(0,e.t0)(e.t1),console.timeEnd("preprocess"),console.time("inference"),e.next=10,N(a);case 10:return r=e.sent,console.timeEnd("inference"),console.time("dimensionalityReduction"),c=O(r),console.timeEnd("dimensionalityReduction"),console.time("clustering"),o=k(c,n),console.timeEnd("clustering"),s=x.h().domain(x.a(a,(function(e){return e.count}))).range([10,30]),a.forEach((function(e,t){e.x=e.x0=600*c[t][0],e.y=e.y0=600*c[t][1],e.group=o[t],e.r=s(e.count)})),console.time("improveLayout"),S(a),console.timeEnd("improveLayout"),e.abrupt("return",a);case 24:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A=function(e,t,n,a){var r=document.createElementNS("http://www.w3.org/2000/svg","text");r.textContent=e,r.setAttributeNS(null,"font-family",n),r.setAttributeNS(null,"font-weight",a);var c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.appendChild(r),document.body.appendChild(c);for(var o=0,s=100,i=0;i<10;++i){var u=(o+s)/2;r.setAttributeNS(null,"font-size",u);var l=r.getBBox(),m=l.width,f=l.height;Math.sqrt(Math.pow(m,2)+Math.pow(f,2))/2<=t?o=u:s=u}return document.body.removeChild(c),o},B=function(e){var t=e.words,n=10,a=10,c=600+a+10,s=600+n+10,i=300/Math.max.apply(Math,[Math.abs(Math.min.apply(Math,Object(o.a)(t.map((function(e){return e.x-e.r}))))),Math.abs(Math.max.apply(Math,Object(o.a)(t.map((function(e){return e.x+e.r}))))),Math.abs(Math.min.apply(Math,Object(o.a)(t.map((function(e){return e.y-e.r}))))),Math.abs(Math.max.apply(Math,Object(o.a)(t.map((function(e){return e.y+e.r})))))]),u=x.g(x.i);return r.a.createElement("svg",{className:"chart",viewBox:"0 0 ".concat(c," ").concat(s)},r.a.createElement("g",{transform:"translate(".concat(a,",").concat(n,")")},r.a.createElement("g",{transform:"translate(".concat(300,",").concat(300,")")},t.map((function(e){return r.a.createElement("g",{key:e.word,transform:"translate(".concat(e.x*i,",").concat(e.y*i,")scale(").concat(i,")")},r.a.createElement("circle",{r:e.r,fill:u(e.group)}),r.a.createElement("text",{fill:"ghostwhite",fontSize:A(e.word,e.r),fontFamily:"'Sawarabi Gothic', sans-serif",fontWeight:"normal",textAnchor:"middle",dominantBaseline:"central"},e.word))})))))},z=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1];return r.a.createElement("div",null,r.a.createElement("section",{className:"hero is-dark"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"title"},"Semantic Preserving Word Bubbles"),r.a.createElement("h2",{className:"subtitle"},"As an Alternative to WordClouds for Text Visualization")))),r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:function(){var e=Object(m.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.elements.text.value,a=+t.target.elements.numClusters.value,e.t0=c,e.next=6,C(n,a);case 6:e.t1=e.sent,(0,e.t0)(e.t1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Input Text"),r.a.createElement("div",{className:"control"},r.a.createElement("textarea",{name:"text",className:"textarea"}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Number of Clusters"),r.a.createElement("div",{className:"control"},r.a.createElement("input",{name:"numClusters",type:"number",min:"0",max:"10",defaultValue:"5",className:"input"}))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-dark",type:"submit"},"Visualize")))))),r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"container"},r.a.createElement(B,{words:n}))),r.a.createElement("footer",{className:"footer"},r.a.createElement("div",{className:"content has-text-centered"},r.a.createElement("p",null,"\xa9 2020 Yosuke Onoue"))))};Object(c.render)(r.a.createElement(z,null),document.getElementById("content"))}},[[210,1,2]]]);
//# sourceMappingURL=main.31e58d05.chunk.js.map